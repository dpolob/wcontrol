experiment: "experimentoA9"
descripcion: | 
  720-72 con SME, sin duplicate teaching, shuffle False, scheduler False, sin dias semana
  
prediccion: "temperatura"
pasado: 144
futuro: 72
paths:
  zmodel:
    dataset: "/home/diego/weather-control/experiments/{{experiment}}/data/dataset_estaciones.pickle"
    dataset_metadata: "/home/diego/weather-control/experiments/{{experiment}}/data/dataset_estaciones.yaml"
    # esta ruta se coloca fuera de la carpeta del experimento porque son datos comunes
    runs: "/home/diego/weather-control/experiments/{{experiment}}/zmodel/runs/"
    checkpoints: "/home/diego/weather-control/experiments/{{experiment}}/zmodel/checkpoints/"
    model: "/home/diego/weather-control/experiments/{{experiment}}/zmodel/model.pth"
    predictions: "/home/diego/weather-control/experiments/{{experiment}}/zmodel/outputs/prediccion_test.pickle"
    viz: "/home/diego/weather-control/experiments/{{experiment}}/zmodel/outputs/viz/"
    
  pmodel:
    dataset: "/home/diego/weather-control/data/processed/dataset_pmodel.pickle"
    
    #zmodel_predictions: "/home/diego/weather-control/experiments/{{experiment}}/pmodel/"
    # esta ruta se coloca fuera de la carpeta del experimento porque son datos comunes
    runs: "/home/diego/weather-control/experiments/{{experiment}}/pmodel/runs/"
    checkpoints: "/home/diego/weather-control/experiments/{{experiment}}/pmodel/checkpoints/"
  
preprocesado:
  outliers:
    temperatura:
      min: -10
      max: 43
      tol: 10
    hr:
      min: 0
      max: 100
      tol: 0
    precipitacion:
      min: 0
      max: 104 # desde 2010
      tol: 0
  escaladores:
    temperatura:
      min: -20
      max: 50
    hr:
      min: 0
      max: 100
    precipitacion:
      min: 0
      max: 30 
zmodel:    
  estaciones:
    - nombre: "Villar de Torre"
      id: 25
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/25.csv"
      longitud: -2.8596367
      latitud: 42.3809186
      altitud: 727
    # - nombre: "Pazuengos"
    #   id: 28
    #   format: "%Y-%m-%d %H:%M:%S"
    #   metricas:
    #     - temperatura
    #     - hr
    #     - precipitacion
    #   ruta: "/home/diego/weather-control/data/processed/28.csv"
    #   longitud: 2.9137689
    #   latitud: 42.3429392
    #   altitud: 1299
    # - nombre: "Arenzana de Abajo"
    #   id: 35
    #   format: "%Y-%m-%d %H:%M:%S"
    #   metricas:
    #     - temperatura
    #     - hr
    #     - precipitacion
    #   ruta: "/home/diego/weather-control/data/processed/35.csv"
    #   longitud: -2.7242639
    #   latitud: 42.3925069
    #   altitud: 523
    - nombre: "Baños de Río Tobía"
      id: 102
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/102.csv"
      longitud: -2.7540781
      latitud: 42.3424721
      altitud: 566
    # - nombre: "Nájera"
    #   id: 1289
    #   format: "%Y-%m-%d %H:%M:%S"
    #   metricas:
    #     - temperatura
    #     - hr
    #     - precipitacion
    #   ruta: "/home/diego/weather-control/data/processed/1289.csv"
    #   longitud: -2.7266667
    #   latitud: 42.4141667
    #   altitud: 500
    # - nombre: "Arenzana de Abajo"
    #   id: 2082
    #   format: "%Y-%m-%d %H:%M:%S"
    #   metricas:
    #     - temperatura
    #     - hr
    #     - precipitacion
    #   ruta: "/home/diego/weather-control/data/processed/2082.csv"
    #   longitud: -2.7357180
    #   latitud: 42.3828770
    #   altitud: 510            
    - nombre: "Badaran-El Hombro"
      id: 2684
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/2684.csv"
      longitud: -2.8634773
      latitud: 42.3721760
      altitud: 751
    - nombre: "Somalcampo"
      id: 2698
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/2698.csv"
      longitud: -2.8912790
      latitud: 42.3905560
      altitud: 815
    - nombre: "Villaverde"
      id: 2706
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/2706.csv"
      longitud: -2.7978570
      latitud: 42.3320800
      altitud: 782
    - nombre: "Cordovin"
      id: 2966
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/2966.csv"
      longitud: -2.8147230
      latitud: 42.3867790
      altitud: 594
    - nombre: "Cabezos"
      id: 3002
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/3002.csv"
      longitud: -2.7905110
      latitud: 42.4101020
      altitud: 600
    - nombre: "Recilla"
      id: 3003
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/3003.csv"
      longitud: -2.8386430
      latitud: 42.4157540
      altitud: 700
    - nombre: "San Roque"
      id: 3005
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/3005.csv"
      longitud: -2.7683200
      latitud: 42.4172120
      altitud: 600
  model:
    name: "seq2seq_2layers"
    epochs: 30
    use_cuda: True
    save_model: True
    plot_intermediate_results: False
    early_stop: 5
    teacher_forcing: 0.2
    duplicate_teaching: 400
    loss_function:
      loss_fn: "maxMSE"
      reduction: 'none'
      coefs: (None, None)
    scheduler: False
    encoder:
      lr: 0.01
      rnn_num_layers: 1
      hidden_size: 100
      bidirectional: False
      rnn_dropout: 0.0  # only for rnn_num_layers > 1
      features:
      - 'hr'
      - 'precipitacion'
      - 'biotemperatura'
      - 'integraltermica'
      - 'integralrain'
      - 'indicelasser'
      - 'indicelang'
      - 'indiceangtrom'
      - 'indicegasparin'
      - 'indicemartonne'
      - 'indicebirot'
      - 'indicehugling'
      - 'tempmacd'
      - 'tempmacdsenal'
      - 'hrmacd'
      - 'hrmacdsenal'
      - 'precipitacionmacd'
      - 'precipitacionmacdsenal'
      - 'dia_sin'
      - 'dia_cos'
      - 'mes_sin'
      - 'mes_cos'
      - 'distancia'
      - 'altitud'
    decoder:
      lr: 0.005
      hidden_size: 100
      dropout: 0.0
      features:
      - 'dia_sin'
      - 'dia_cos'
      - 'mes_sin'
      - 'mes_cos'
      - 'distancia'
      - 'altitud'
  dataloaders:
    train:
      enable: True
      fecha_inicio: "2018-01-01 00:00:00"
      fecha_fin: "2020-12-31 23:00:00"
      shuffle: False
    validation:
      enable: True
      fecha_inicio: "2021-01-01 00:00:00"
      fecha_fin: "2021-04-30 23:00:00"
      shuffle: False
    test:
      enable: True
      fecha_inicio: "2021-05-01 00:00:00"
      fecha_fin: "2021-05-30 23:00:00"
      use_checkpoint: 'best' 
  resultados:
    visualizacion:
      muestras: "range" # random, all, list, range
      inicio: 0
      fin: "end"
      paso: 50
      
pmodel:
  estaciones:
    - nombre: "Villaverde"
      id: 2706
      format: "%Y-%m-%d %H:%M:%S"
      metricas:
        - temperatura
        - hr
        - precipitacion
      ruta: "/home/diego/weather-control/data/processed/2706.csv"
      longitud: -2.7978570
      latitud: 42.3320800
      altitud: 782
  model:
    name: "pmodel"
    epochs: 40
    use_cuda: True
    save_model: True
    plot_intermediate_results: True
    use_checkpoint_from_zmodel: 'best'
  dataloaders:
    train:
      enable: True
      fecha_inicio: "2020-03-02 00:00:00" # no puede ser el comienzo del archivo (2020-02-27) dejar al menos dejar pasados dias
      fecha_fin: "2021-08-11 23:00:00" # no puede ser el final del archivo (2021-08-15) dejar al menso futuros dias
   